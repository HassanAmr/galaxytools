<tool id="high-throughput_sequencing_metadata" name="High-Throughput Sequencing Metadata" version="2.1">
    <description>High-throughput sequencing metadata template</description>
    <requirements>
    </requirements>
    <command interpreter="python">
<![CDATA[
        high-throughput_sequencing_metadata_template.py
            --num-threads "\${GALAXY_SLOTS:-12}"
            --blastdb ${database.fields.path}
            --locus-tag $locus_tag
            --trainingset $trainingset
            --agp-file $agp_file
            --translation-table $translationTable
            --cleaned-sequence $cleaned_sequence
]]>
  </command>
  <inputs>
    <param name="database" type="select" label="Protein BLAST database">
        <options from_file="blastdb_p.loc">
            <column name="value" index="0"/>
            <column name="name" index="1"/>
            <column name="path" index="2"/>
        </options>
    </param>
    <param name="cleaned_sequence" type="data" format="fasta" label="FASTA sequence file" help="Dataset missing? See TIP below"/>
    <param name="locus_tag" type="text" value="SCI" label="Locus Tag" help="Please specify a locus_tag prefix, it must be at least 3 characters."/>
    <param name="agp_file" type="data" format="tabular" label="AGP file containing the scaffold information." help="Its generated in the scaffold2fasta tool."/>

        <param name="trainingset" label="Model Organism" type="select" multiple="false" format="text" help="Choose a specialised trainingset.">
            <option value="human">Homo sapiens</option>
        </param>

        <param name="translationTable" type="select" label="NCBI Translation Table">
              <option value="1">The Standard Code (1)</option>
        </param>

        <conditional name="adv_opts">
            <param name="adv_opts_selector" type="select" label="Advanced Options">
                <option value="basic" selected="True">Hide Advanced Options</option>
                <option value="advanced">Show Advanced Options</option>
            </param>
            <when value="basic" />
            <when value="advanced">
                <param name="outputs" type="select" multiple="true" label="Output formats">
                    <option value="genbank_file" selected="True">Annotated Genome (GenBank)</option>
                </param>
                <param name="coverage" type="float" value="0.5" label="minimal coverage" help="Minimal coverage of a BLAST hit to include the annotation in the output.">
                    <validator type="in_range" min="0" max="1"/>
                </param>
                <param name="identity" type="float" value="0.5" label="minimal identity" help="Minimal identity of a BLAST hit to include the annotation in the output.">
                    <validator type="in_range" min="0" max="1"/>
                </param>
                <param name="sbt_file" type="data" format="txt" optional="True" label="SBT File" help="The NCBI author file. It can be created on the ncbi page. http://www.ncbi.nlm.nih.gov/WebSub/template.cgi"/>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data format="txt" name="featureTable" label="Eukaryotic annotation (FeatureTable)">
            <filter>adv_opts['adv_opts_selector'] == 'advanced' and 'feature_table' in adv_opts['outputs']</filter>
        </data>
        <data format="genbank" name="genbank_file" label="Eukaryotic annotation (Genbank)">
          <filter>adv_opts['adv_opts_selector'] == 'basic' or (adv_opts['adv_opts_selector'] == 'advanced' and 'genbank_file' in adv_opts['outputs'])</filter>
        </data>
        <data format="txt" name="sequin_file" label="Eukaryotic annotation (Sequin)">
          <filter>adv_opts['adv_opts_selector'] == 'advanced' and 'sequin_file' in adv_opts['outputs']</filter>
        </data>
        <data format="txt" name="validation_file" label="Eukaryotic annotation (Validation)" >
          <filter>adv_opts['adv_opts_selector'] == 'advanced' and 'validation_file' in adv_opts['outputs']</filter>
        </data>
        <data format="txt" name="discrepancy_report" label="Eukaryotic annotation (Discrepancy report)" >
          <filter>adv_opts['adv_opts_selector'] == 'basic' or (adv_opts['adv_opts_selector'] == 'advanced' and 'discrepancy_file' in adv_opts['outputs'])</filter>
        </data>
        <data format="tar.gz" name="compressed_archive" label="All files required for NCBI submission" >
          <filter>adv_opts['adv_opts_selector'] == 'basic' or (adv_opts['adv_opts_selector'] == 'advanced' and 'compressed_archive' in adv_opts['outputs'])</filter>
        </data>
    </outputs>
    <tests>
        <test>
        </test>
    </tests>

<help>
<![CDATA[

High-throughput sequencing metadata template (version 2.1).
All fields in this template must be completed.
Templates containing example data are found in the METADATA EXAMPLES spreadsheet tabs at the foot of this page.
Field names (in blue on this page) should not be edited. Hover over cells containing field names to view field content guidelines.
Human data. If there are patient privacy concerns regarding making data fully public through GEO, please submit to NCBI's dbGaP (http://www.ncbi.nlm.nih.gov/gap/) database. dbGaP has controlled access mechanisms and is an appropriate resource for hosting sensitive patient data.

-----

**Sections**

- SERIES
    This section describes the overall experiment.


- SAMPLES
    This section lists and describes each of the biological Samples under investgation, as well as any protocols that are specific to individual Samples.
    Additional "processed data file" or "raw file" columns may be included.


- PROTOCOLS
    Any of the protocols below which are applicable to only a subset of Samples should be included as additional columns of the SAMPLES section instead.                                                        


- DATA PROCESSING PIPELINE
    Data processing steps include base-calling, alignment, filtering, peak-calling, generation of normalized abundance measurements etcâ€¦
    For each step provide a description, as well as software name, version, parameters, if applicable.
    Include additional steps, as necessary.


- PROCESSED DATA FILES
    For each file listed in the "processed data file" columns of the SAMPLES section, provide additional information below.


- RAW FILES
    For each file listed in the "raw file" columns of the SAMPLES section, provide additional information below.


- PAIRED-END EXPERIMENTS
    For paired-end experiments, list the 2 associated raw files, and provide average insert size and standard deviation, if known. For SOLiD experiments, list the 4 file names (include "file name 3" and "file name 4" columns).

]]>
    </help>
</tool>
